<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Transcripciones en Tiempo Real</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #23272e;
            color: #e6e6e6;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px;
        }
        .client-box {
            background: #2d313a;
            border: 1.5px solid #4a4e57;
            border-radius: 12px;
            padding: 16px;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.18);
        }
        .client-title {
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
            font-size: 1.1em;
            letter-spacing: 0.5px;
        }
        .transcription {
            white-space: pre-line;
            color: #e6e6e6;
        }
    </style>
</head>
<body>
    <h2 style="text-align:center;">Transcripciones en Tiempo Real</h2>
    <div class="container" id="clients"></div>
    <script>
        const ws = new WebSocket("ws://localhost:8765");
        const clients = {};
        const container = document.getElementById('clients');

        ws.onmessage = (event) => {
            let data;
            try {
                data = JSON.parse(event.data);
            } catch (e) {
                return;
            }
            const clientId = data.client_id || 'Desconocido';
            const transcription = data.transcription || '';
            if (!clients[clientId]) {
                // Crear caja nueva
                const box = document.createElement('div');
                box.className = 'client-box';
                box.id = 'client-' + clientId;
                box.innerHTML = `<div class="client-title">${clientId}</div><div class="transcription" id="trans-${clientId}"></div>`;
                container.appendChild(box);
                clients[clientId] = box;
            }
            // Agregar la transcripci√≥n (acumular)
            const transDiv = document.getElementById('trans-' + clientId);
            transDiv.textContent += transcription + '\n';
            transDiv.scrollTop = transDiv.scrollHeight;
        };
    </script>
</body>
</html>
